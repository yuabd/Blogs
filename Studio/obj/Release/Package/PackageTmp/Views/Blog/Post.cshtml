@model Studio.Models.Site.BlogViewModel
@{
    ViewBag.Title = Model.Blog.BlogTitle;
    Layout = "~/Views/Shared/_SiteLayout.cshtml";
    ViewBag.MetaKeywords = Model.Blog.MetaKeywords;
    ViewBag.MetaDescription = Model.Blog.MetaDescription;
}
@section head {
    <link href="/Scripts/SintaxHighlighter/sh.css" rel="stylesheet" type="text/css" />
    <style>
        .about
        {
            margin: 0px 10px 10px 10px;
            border: 1px dashed #dddddd;
            margin-top: 25px;
            padding: 15px;
            background: #F9F9F9;
            text-align: left;
        }
        #cont
        {
            padding: 15px;
            color: #a1a1a1;
        }
        .newsRel
        {
            border-top-color: #CCCCCC;
            border-top-style: dashed;
            border-top-width: 1px;
            clear: both;
            color: #666666;
            line-height: 24px;
            margin: 20px 0 10px;
            padding-top: 10px;
        }
    </style>
}
@section scripts{
    @*<script src="/Scripts/jquery.validate.min.js" type="text/javascript"></script>
	<script src="/Scripts/jquery.validate.unobtrusive.min.js" type="text/javascript"></script>*@
    <script src="/Scripts/SintaxHighlighter/sh.min.js" type="text/javascript"></script>
    <script src="/Plugins/wordCount/readingTime.js" type="text/javascript"></script>
    <script>
        $(function () {
            $('#word-count').readingTime({
                wordCountTarget: '.words'
            });
        });
    </script>
}
<div class="pg-opt pin">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <h2>@Model.Blog.BlogTitle</h2>
            </div>
            <div class="col-md-6">
                <ol class="breadcrumb">
                    <li><a href="http://www.henhaoji.com.cn" title="巨易首页">首页</a></li>
                    <li><a href="http://www.henhaoji.com.cn/blog/index.html" title="新闻动态">新闻动态</a></li>
                    <li class="active">@Model.Blog.BlogTitle</li>
                </ol>
            </div>
        </div>
    </div>
</div>
<section class="slice animate-hover-slide">
	<div class="w-section inverse blog-grid">
    	<div class="container">
        	<div class="row">
                <div class="col-md-8">
                	<div class="row">
                    	<div class="col-md-12">
                        	<div class="w-box blog-post">
                                <figure id="cont">
                                    <img alt="@Model.Blog.BlogTitle" data-original="@Model.Blog.PictureFolder/@Model.Blog.PictureThumbnail" class="img-responsive lazy" />
                                    <span class="date-over"><strong>@Model.Blog.BlogCategory.CategoryName</strong></span>
                                    <h2>@Model.Blog.BlogTitle</h2>
									<div id="word-count">
                                    <ul class="meta-list">
                                        <li>
                                            <span>作者:</span>
                                            <span class="bold">@Model.Blog.AuthorID</span>
                                        </li>
                                        <li>
                                            <span>-</span>
                                            <a href="#">@Model.Blog.DateCreated</a>
                                        </li>
										<li>
                                            <span>访问量:</span>
                                            <a href="#">@Model.Blog.PageVisits</a>
                                        </li>
										<li>
											<small>预计阅读用时<span class="eta" style="color: #e06d58;"></span> (<span class="words" style="color: #e06d58;"></span> 字)</small>
										</li>
                                    </ul>
									
                                    @Html.Raw(Model.Blog.BlogContent)
									
									</div>
									<p>
										本文关键字: 
										@foreach (var item in Model.Blog.BlogTags)
          {
			  <b>@item.Tag</b> 
          }
										
									</p>
									@*<div class="about clearfix">
										本文由<a href="http://www.henhaoji.com.cn" title="厦门网站建设"><b>厦门网站建设</b></a>品牌巨易科技(www.henhaoji.com.cn)原创编辑，转发请注明来源及版权归属。<br />
                                        原文地址:：<a href="http://www.henhaoji.com.cn/blog/post/@(Model.Blog.Slug).html" 
                                        title="@Model.Blog.BlogTitle">http://www.henhaoji.com.cn/blog/post/@(Model.Blog.Slug).html</a>
									</div>*@
									<div class="newsRel clearfix">
										上一篇：
										@if (Model.PreNextBlog.PreBlog != null)
          {
			  <a href="/Blog/Post/@(Model.PreNextBlog.PreBlog.Slug).html" title="@Model.PreNextBlog.PreBlog.Title">@Model.PreNextBlog.PreBlog.Title</a>
          }
          else
          {
			  <a href="#" title="厦门网站建设">没有上一篇了</a>
          }
										
										<br/>
										下一篇：
										@if (Model.PreNextBlog.NextBlog != null)
          {
						<a href="/Blog/Post/@(Model.PreNextBlog.NextBlog.Slug).html" title="@Model.PreNextBlog.NextBlog.Title">@Model.PreNextBlog.NextBlog.Title</a>  
          }
          else
          {
			  <a href="#" title="厦门网站建设">没有下一篇了</a>
          }
									</div>
                                </figure>
                            </div>
                            
                            <div class="w-box inner">
                                <div class="comments-wr">
									<!-- 多说评论框 start -->
									<div class="ds-thread" data-thread-key="@Model.Blog.BlogID" data-title="@Model.Blog.BlogTitle" data-url="http://www.henhaoji.com.cn/blog/post/@(Model.Blog.Slug).html"></div>
									<!-- 多说评论框 end -->
									<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
									<script type="text/javascript">
									    var duoshuoQuery = { short_name: "henhaoji" };
									    (function () {
									        var ds = document.createElement('script');
									        ds.type = 'text/javascript'; ds.async = true;
									        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
									        ds.charset = 'UTF-8';
									        (document.getElementsByTagName('head')[0]
										 || document.getElementsByTagName('body')[0]).appendChild(ds);
									    })();
									</script>
									<!-- 多说公共JS代码 end -->
									
                                	@*<h2><strong>@Model.BlogComments.Count()</strong> 条评论</h2>
                                    @foreach (var item in Model.BlogComments)
									{
										<div class="comment">
											<img data-original="http://www.gravatar.com/avatar/@item.GravatarHash?d=monsterid" class="lazy" alt="@item.Name" />
											<p><b>@item.Name</b>: @item.Message</p>
										</div>
									}*@
                                </div>
                            </div>
                            
                            @*<div class="w-box inner">
                            	<div class="comment-form">
                                	<h2>评论</h2>
                                    <form class="form-default" id="pos-comment" action="/Blog/AddComment.html" method="post">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="firstName">姓名</label>
													@Html.TextBoxFor(m => m.BlogComment.Name, new { @class = "form-control", placeholder = "姓名*必填" })
													@Html.ValidationMessageFor(m => m.BlogComment.Name)
                                                    
                                                </div>
                                            </div>
                                            
                                        </div>           
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="email">邮箱/Email</label>
													@Html.TextBoxFor(m => m.BlogComment.Email, new { @class = "form-control", placeholder = "邮箱*必填" })
													@Html.ValidationMessageFor(m => m.BlogComment.Email)
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="website">网址</label>
													@Html.TextBoxFor(m => m.BlogComment.Website, new { @class = "form-control", placeholder = "网址" })
													@Html.ValidationMessageFor(m => m.BlogComment.Website)
                                                </div>
                                            </div>
                                        </div> 
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="comment">评论</label>
													@Html.TextAreaFor(m => m.BlogComment.Message, new { @class = "form-control", style = "min-height:90px;", placeholder = "留下您的意见或建议*必填" })
													@Html.ValidationMessageFor(m => m.BlogComment.Message)
                                                </div>
                                            </div>
                                        </div>
										<div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
													<label for="comment">验证码(<span style="color: Orange;">@Model.BlogComment.ValidationCodeSource</span>)</label>
													@Html.TextBoxFor(m => m.BlogComment.ValidationCodeMatch, new { @class = "form-control", placeholder = "此处填写上方黄色的3位数字*必填" })
													@Html.ValidationMessageFor(m => m.BlogComment.ValidationCodeMatch)
												</div>
											</div>
										</div>
										@Html.HiddenFor(m => m.BlogComment.ValidationCodeSource)
										@Html.HiddenFor(m => m.BlogComment.BlogID)
										@Html.HiddenFor(m => m.BlogComment.IsPublic)
                                        <div class="row">
                                        	<div class="col-md-6">
                                            </div>
                                            <div class="col-md-6">
                                            	<button type="submit" class="btn btn-three pull-right" title="提交"><i class="fa fa-comment-o"></i> 提交</button>
                                            </div>
                                        </div>     
                                    </form>
                                </div>
                            </div>*@
                        </div>
                    </div>
                </div>
                                        
                <div class="col-md-4">
                    <div class="widget">
                        @*<form class="form-inline" action="/Blog/index.html" method="post">*@
                            <div class="input-group">
                                <input type="text" id="key1" name="keywords" onkeydown="if (event.keyCode == 13) Sumbit1()" class="form-control" placeholder="搜索信息..." />
                                <span class="input-group-btn">
                                    <button class="btn btn-primary" type="button" onclick="Sumbit1()">Go!</button>
                                </span>
                            </div>
                        @*</form>*@
                        <script>
                            function Sumbit1() {
                                var key = $("#key1").val();
                                window.location.href = "/blog/index.html?keywords=" + key;
                            }
                        </script>
                    </div>
                    <div class="widget">
                        <h4 class="widget-heading">分类</h4>

                        <ul class="categories highlight">
                            @foreach (var item in Model.Categories)
                            {
							<li><a href="/Blog/Categories/@(item.CategoryID).html" title="@item.CategoryName">@item.CategoryName</a></li>
                            }
                        </ul>
                    </div>
                    <div class="widget">
                        <h4 class="widget-heading">归档</h4>

                        <ul class="categories highlight">
							@foreach (var item in Model.Archives)
       {
           if (!string.IsNullOrEmpty(item.Month))
           {
				<li><a href="/Blog/Archives/@(item.Year).html/?month=@(item.Month)">@(item.Month) (@item.Count)</a></li>
           }
           else
           {
				<li><a href="/Blog/Archives/@(item.Year).html">@item.Year (@item.Count)</a></li>
           }
       }
                        </ul>
                    </div>
                    <div class="widget">
                        <h4 class="widget-heading hide">推荐</h4>
                        <div class="tabs">
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#one" data-toggle="tab"> 猜你喜欢</a></li>
								<li><a href="#two" data-toggle="tab"> 最新评论</a></li>
								<li><a href="#three" data-toggle="tab"> 热门新闻</a></li>
								<li><a href="#four" data-toggle="tab"> 随机文章</a></li>
                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane active" id="one">
									<ul class="popular">
                                    @{
                                        var keywords = new List<string>();
                                        if (!string.IsNullOrEmpty(Model.Blog.MetaKeywords))
                                        {
                                            keywords = Model.Blog.MetaKeywords.Split(',').ToList();
                                        }
                                        var list = new Studio.Services.BlogHelp().GetBlogs().Where(m => m.IsPublic == true && m.BlogID != Model.Blog.BlogID && !string.IsNullOrEmpty(m.MetaKeywords)).ToList();
                                        foreach (var item in keywords)
                                        {
                                            list = (from m in list
                                                    where (m.MetaKeywords.Contains(item) || m.BlogContent.Contains(item))
                                                    select m).ToList();
                                        }
                                        //list = list.ToList();
                                        var coun = list.Count;
                                        if (coun < 6)
                                        {
                                            list.AddRange(new Studio.Services.BlogHelp().GetBlogs().Where(m => m.IsPublic == true).OrderBy(m => Guid.NewGuid()).Take(6 - coun).ToList());
                                        }
                                        else
                                        {
                                            list = list.Take(6).ToList();
                                        }
										}
                                        
                                        @foreach (var item in list)
                                        {
										<li>
                                            <img data-original="@item.PictureFolder/@item.PictureThumbnail" alt="@item.BlogTitle" class="lazy img-thumbnail pull-left">
                                            <p>
                                                <a href="/Blog/Post/@(item.Slug).html" title="@item.BlogTitle">@item.BlogTitle</a>
                                                <i>@item.DateCreated</i>
                                            </p>
                                        </li>
                                        }
									</ul>
								</div>
                                <div class="tab-pane" id="two">
									<ul class="popular">
										@*@foreach (var item in new Studio.Services.BlogHelp().GetComments().Where(m => m.IsPublic == true).Take(6))
		  {
										<li>
											<img data-original="http://www.gravatar.com/avatar/@item.GravatarHash?d=monsterid" alt="@item.Name" class="lazy img-thumbnail pull-left" />
											<p>
												@item.Message
												<i>@(item.Name) 在 <a href="/Blog/Post/@(item.Blog.Slug).html" title="@item.Blog.BlogTitle">@item.Blog.BlogTitle</a>中评论</i>
											</p>
                                        </li>
		  }*@
										<!-- 多说最新评论 start -->
											<div class="ds-recent-comments" data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="70"></div>
										<!-- 多说最新评论 end -->
										<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
										<script type="text/javascript">
										    var duoshuoQuery = { short_name: "henhaoji" };
										    (function () {
										        var ds = document.createElement('script');
										        ds.type = 'text/javascript'; ds.async = true;
										        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
										        ds.charset = 'UTF-8';
										        (document.getElementsByTagName('head')[0]
												 || document.getElementsByTagName('body')[0]).appendChild(ds);
										    })();
											</script>
										<!-- 多说公共JS代码 end -->
									</ul>
								</div>
								<div class="tab-pane" id="three">
                                    <ul class="popular">
                                        @foreach (var item in new Studio.Services.BlogHelp().GetBlogs().Where(m => m.IsPublic == true).OrderByDescending(m => m.PageVisits).Take(5).ToList())
                                        {
										<li>
                                            <img data-original="@item.PictureFolder/@item.PictureThumbnail" alt="@item.BlogTitle" class="lazy img-thumbnail pull-left">
                                            <p>
                                                <a href="/Blog/Post/@(item.Slug).html" title="@item.BlogTitle">@item.BlogTitle</a>
                                                <i>@item.DateCreated</i>
                                            </p>
                                        </li>
                                        }
                                    </ul>
                                </div>
								<div class="tab-pane" id="four">
                                    <ul class="popular">
										@foreach (var item in new Studio.Services.BlogHelp().GetBlogs().Where(m => m.IsPublic == true).OrderBy(m => Guid.NewGuid()).Take(6))
          {
										<li>
											<img data-original="@item.PictureFolder/@item.PictureThumbnail" alt="@item.BlogTitle" class="img-thumbnail pull-left lazy" />
                                            <p>
                                                <a href="/Blog/Post/@(item.Slug).html" title="@item.BlogTitle">@item.BlogTitle</a>
                                                <i>@item.DateCreated</i>
                                            </p>
                                        </li>
          }
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
					<div class="widget">
						<h4 class="widget-heading">最近访客</h4>
						<ul class="ds-recent-visitors" data-num-items="30" data-show-time="0" data-avatar-size="50"></ul>
						<script>
						    if (typeof DUOSHUO !== 'undefined')
						        DUOSHUO.RecentVisitors('.ds-recent-visitors');
						</script>
					</div>
                    <div class="widget tags-wr">
                        <h4 class="widget-heading">话题</h4>
                        <ul class="tags-list">
							@foreach (var item in Model.PopularTags)
       {
							<li><i class="fa fa-tags"></i> <a href="/Blog/Tags/@(item.Tag).html" title="@item.Tag">@(item.Tag)(@item.Num)</a></li>
       }
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
